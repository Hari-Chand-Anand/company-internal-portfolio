<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Projects â€¢ HCA Internal Portfolio</title>
  <link rel="stylesheet" href="assets/styles.css" />
</head>
<body>
  <header class="topbar">
    <div class="row">
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <div class="title">Projects</div>
          <div class="subtitle">Solution bundles (step-wise machines)</div>
        </div>
      </div>
      <nav class="nav" aria-label="Primary">
        <a href="index.html">Home</a>
        <a href="machines.html">Machines</a>
        <a href="projects.html">Projects</a>
        <a href="map.html">Map</a>
      </nav>
      <div class="badge">Internal use</div>
    </div>
  </header>

  <main class="container">
    <section class="hero">
      <h1>Projects</h1>
      <p>Select a project to show the complete machine set used in that production flow.</p>
    </section>

    <div class="toolbar">
      <input class="input" id="q" placeholder="Search projects (e.g., cap, polo)" />
      <button class="btn" id="clear">Clear</button>
      <span class="small" id="count"></span>
    </div>

    <section class="grid cols-3" id="list"></section>

    <div class="footer">Tip: Open a project and use it as a guided sales conversation.</div>
  </main>

  <script src="assets/app.js"></script>
  <script>
    (async () => {
      const projects = await loadData('data/projects.json');
      const list = document.getElementById('list');
      const q = document.getElementById('q');
      const count = document.getElementById('count');

      function render(){
        const term = (q.value || '').trim().toLowerCase();
        const filtered = projects.filter(p => {
          if (!term) return true;
          return (p.title||'').toLowerCase().includes(term) || (p.summary||'').toLowerCase().includes(term);
        });

        count.textContent = `${filtered.length} project(s)`;
        list.innerHTML = filtered.map(p => `
          <a class="card" href="project.html?id=${encodeURIComponent(p.id)}">
            <h3>${safeText(p.title)}</h3>
            <p>${safeText(p.summary)}</p>
            <div class="divider"></div>
            <div class="meta">
              <span class="small">Steps: ${safeText((p.steps||[]).length)}</span>
              <span class="pill"><span class="dot ok"></span> Open</span>
            </div>
          </a>
        `).join('');
      }

      q.addEventListener('input', render);
      document.getElementById('clear').addEventListener('click', () => { q.value=''; render(); q.focus(); });
      render();
    })().catch(err => {
      console.error(err);
      document.getElementById('list').innerHTML = '<div class="card"><h3>Error</h3><p>Failed to load projects data.</p></div>';
    });
  </script>
</body>
</html>
